<!DOCTYPE html>
<html>

<head>
  <!-- アドレスバー等のブラウザのUIを非表示 -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <!-- default（Safariと同じ） / black（黒） / black-translucent（ステータスバーをコンテンツに含める） -->
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <!-- ホーム画面に表示されるアプリ名 -->
  <meta name="プロジェクト演習アプリ" content="TAP10">
  <!-- ホーム画面に表示されるアプリアイコン -->
  <link rel="apple-touch-icon" href="images\app-icon-alarm.png">
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="manifest" href="manifest.json">
  <title>プロジェクト演習アプリ</title>
  <link rel="stylesheet" href="css/common.css">
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
  <!-- CDN jquery -->
  <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"
    integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo"
    crossorigin="anonymous"></script>
</head>

<body>
  <header>

  </header>
  <nav>
    <ul>
      <li><a href="sound.html"></a></li>
    </ul>
  </nav>
  <div class="container-fluid">
    <div id="timerText">0:00:00</div>
    <form name="alarm_form">
      <p class="bg-light">アラーム:
        <select name="option_hours">
          <option value='0'>00</option>
          <option value='1'>01</option>
          <option value='2'>02</option>
          <option value='3'>03</option>
          <option value='4'>04</option>
          <option value='5'>05</option>
          <option value='6'>06</option>
          <option value='7'>07</option>
          <option value='8'>08</option>
          <option value='9'>09</option>
          <option value='10'>10</option>
          <option value='11'>11</option>
          <option value='12'>12</option>
          <option value='13'>13</option>
          <option value='14'>14</option>
          <option value='15'>15</option>
          <option value='16'>16</option>
          <option value='17'>17</option>
          <option value='18'>18</option>
          <option value='19'>19</option>
          <option value='20'>20</option>
          <option value='21'>21</option>
          <option value='22'>22</option>
          <option value='23'>23</option>
        </select>
        <select name="option_minutes">
          <option value='0'>00</option>
          <option value='1'>01</option>
          <option value='2'>02</option>
          <option value='3'>03</option>
          <option value='4'>04</option>
          <option value='5'>05</option>
          <option value='6'>06</option>
          <option value='7'>07</option>
          <option value='8'>08</option>
          <option value='9'>09</option>
          <option value='10'>10</option>
          <option value='11'>11</option>
          <option value='12'>12</option>
          <option value='13'>13</option>
          <option value='14'>14</option>
          <option value='15'>15</option>
          <option value='16'>16</option>
          <option value='17'>17</option>
          <option value='18'>18</option>
          <option value='19'>19</option>
          <option value='20'>20</option>
          <option value='21'>21</option>
          <option value='22'>22</option>
          <option value='23'>23</option>
          <option value='24'>24</option>
          <option value='25'>25</option>
          <option value='26'>26</option>
          <option value='27'>27</option>
          <option value='28'>28</option>
          <option value='29'>29</option>
          <option value='30'>30</option>
          <option value='31'>31</option>
          <option value='32'>32</option>
          <option value='33'>33</option>
          <option value='34'>34</option>
          <option value='35'>35</option>
          <option value='36'>36</option>
          <option value='37'>37</option>
          <option value='38'>38</option>
          <option value='39'>39</option>
          <option value='40'>40</option>
          <option value='41'>41</option>
          <option value='42'>42</option>
          <option value='43'>43</option>
          <option value='44'>44</option>
          <option value='45'>45</option>
          <option value='46'>46</option>
          <option value='47'>47</option>
          <option value='48'>48</option>
          <option value='49'>49</option>
          <option value='50'>50</option>
          <option value='51'>51</option>
          <option value='52'>52</option>
          <option value='53'>53</option>
          <option value='54'>54</option>
          <option value='55'>55</option>
          <option value='56'>56</option>
          <option value='57'>57</option>
          <option value='58'>58</option>
          <option value='59'>59</option>
        </select>
        <span class="btn" id="set_btn">設定</span>
      </p>
    </form>
  </div>
  <div class="container">
    <p>アラーム設定時刻</p>
    <ul class="list-group list-group-flush list-group-numbered " id="parent_list"></ul>
  </div>
  <div>
    <ul id='messages'>
    </ul>
  </div>
  <button id="confirm">通知許可の確認</button>
  <button id="send">通知を送信</button>



  <!-- Option 1: Bootstrap Bundle with Popper -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW"
    crossorigin="anonymous"></script>
  <script src="js/alarm.js"></script>
  <script src="weatherForcast.js"></script>
  <script>
    window.addEventListener('load', () => {
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker
          .register('sw.js')
          .then(registration => console.log('registered', registration))
          .catch(error => console.log('error', error));
      }
    });

    document
      .getElementById('confirm')
      .addEventListener('click', onClickConfirm);

    document.getElementById('send').addEventListener('click', onClickSend);

    function onClickConfirm() {
      if (!('Notification' in window)) {
        alert('このブラウザはプッシュ通知に対応してません。。。');
        return;
      }
      Notification.requestPermission().then(permission => {
        if (permission === 'granted') alert('通知の許可がもらえました');
        if (permission === 'denied') alert('通知の許可がもらえませんでした');
      });
    }


    // 通知メッセージの送信
    function onClickSend() {
      if (!('Notification' in window)) {
        alert('このブラウザはプッシュ通知に対応してません。。。');
        return;
      }

      const permission = Notification.permission;
      if (permission === 'granted') {
        navigator.serviceWorker.ready.then(registration => {
          registration.active.postMessage('hello!!!');
        });
      } else {
        alert('通知の許可がもらえませんよ');
      }
    }
  </script>
</body>

</html>
